# 要件定義書

## 概要

現在のキャラクターデータ生成システムでは、キャラクターの`name`フィールドを HoyoLab API レスポンスから取得していますが、これを Scraping.md ファイル内で定義された固定の name リストの値を使用するように変更する必要があります。この変更により、キャラクター名の一貫性と制御性が向上し、API レスポンスの変動に依存しない安定したデータ生成が可能になります。

## 要件

### 要件 1

**ユーザーストーリー:** 開発者として、キャラクターデータ生成システムが API レスポンスの名前ではなく Scraping.md の事前定義された名前マッピングを使用することで、キャラクター名が一貫性を持ち制御可能になることを望みます。

#### 受け入れ基準

1. システムがキャラクターデータを生成する時、日本語と英語の両方の名前について Scraping.md で定義された名前マッピングを使用すること
2. キャラクター ID が名前リストに存在する時、システムは事前定義されたマッピングから対応する日本語と英語の名前を使用すること
3. システムがキャラクターデータを処理する時、name フィールドについては HoyoLab API レスポンスの名前値を無視すること
4. Character オブジェクトを生成する時、`name`フィールドが事前定義された名前リストから同じ値を使用すること
5. Character オブジェクトを生成する時、`fullName`フィールドは HoyoLab API レスポンスの値を使用すること

### 要件 2

**ユーザーストーリー:** 開発者として、システムが欠落した名前マッピングを適切に処理することで、マッピングされていないキャラクターに遭遇してもデータ生成プロセスが失敗しないことを望みます。

#### 受け入れ基準

1. キャラクター ID が事前定義された名前リストに見つからない時、システムは API レスポンスの名前値にフォールバックすること
2. API 名前にフォールバックする時、システムは欠落したマッピングを示す警告メッセージをログに記録すること
3. フォールバック名前を使用する時、システムは日本語と英語のプロパティを持つ多言語オブジェクト構造を維持すること
4. フォールバック後に処理が続行される時、システムは全体のデータ生成プロセスを終了させないこと

### 要件 3

**ユーザーストーリー:** 開発者として、名前リストが簡単に保守可能でアクセス可能であることで、コア処理ロジックを変更することなく新しいキャラクター名を追加または更新できることを望みます。

#### 受け入れ基準

1. システムが開始される時、中央化された場所から名前マッピングを読み込むこと
2. 名前リストが更新される時、システムは処理ロジックのコード変更を必要とせずに新しいマッピングを使用すること
3. 名前マッピングにアクセスする時、システムはキーとして一貫したキャラクター ID 形式（小文字）を使用すること
4. 名前マッピング構造が変更される時、システムはそれを使用する前にマッピング形式を検証すること

### 要件 4

**ユーザーストーリー:** 開発者として、システムが既存の Character 型定義との後方互換性を維持することで、生成されたデータの下流消費者が影響を受けないことを望みます。

#### 受け入れ基準

1. Character オブジェクトを生成する時、システムは既存の`name: { [key in Lang]: string }`構造を維持すること
2. Character オブジェクトを生成する時、システムは既存の`fullName: { [key in Lang]: string }`構造を維持すること
3. 名前ソースが変更される時、生成された TypeScript ファイルは同じエクスポート形式を維持すること
4. キャラクターデータを処理する時、他のすべてのキャラクタープロパティは現在の実装から変更されないこと
